<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§æ¨¡å‹é¢è¯•é¢˜åº“ - AIæ™ºèƒ½åˆ·é¢˜ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: white;
            border-radius: 16px;
            padding: 24px 32px;
            margin-bottom: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        header h1 {
            font-size: 28px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }
        
        header p {
            color: #666;
            font-size: 14px;
        }
        
        .search-section {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            flex-wrap: wrap;
        }
        
        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 12px 16px;
            border: 2px solid #e8e8e8;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn-crawl {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-crawl:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(238, 90, 36, 0.4);
        }
        
        .btn-crawl:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .crawl-status {
            width: 100%;
            padding: 12px 16px;
            background: #fff3e0;
            border-radius: 8px;
            margin-top: 12px;
            font-size: 14px;
            color: #e65100;
            display: none;
        }
        
        .crawl-status.show {
            display: block;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 24px;
        }
        
        .sidebar {
            background: white;
            border-radius: 16px;
            padding: 24px;
            height: fit-content;
            position: sticky;
            top: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .sidebar h3 {
            font-size: 16px;
            color: #333;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .filter-section {
            margin-bottom: 24px;
        }
        
        .filter-section label {
            display: block;
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .filter-section select {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e8e8e8;
            border-radius: 8px;
            font-size: 14px;
            color: #333;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        
        .filter-section select:hover {
            border-color: #667eea;
        }
        
        .filter-section select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .category-list {
            list-style: none;
        }
        
        .category-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 4px;
        }
        
        .category-item:hover {
            background: #f5f5f5;
        }
        
        .category-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .category-item .name {
            font-size: 14px;
            font-weight: 500;
        }
        
        .category-item .count {
            background: rgba(0, 0, 0, 0.1);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
        }
        
        .category-item.active .count {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: #f8f9ff;
            padding: 16px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-card .value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-card .label {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }
        
        .content-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .question-header {
            background: white;
            border-radius: 16px;
            padding: 20px 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .question-count {
            font-size: 16px;
            color: #333;
        }
        
        .question-count span {
            color: #667eea;
            font-weight: bold;
        }
        
        .action-buttons {
            display: flex;
            gap: 12px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #f5f5f5;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #e8e8e8;
        }
        
        .question-card {
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }
        
        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }
        
        .question-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .tag {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .tag-category {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .tag-difficulty {
            background: #f0f0f0;
            color: #666;
        }
        
        .tag-difficulty.easy {
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        .tag-difficulty.medium {
            background: #fff3e0;
            color: #ef6c00;
        }
        
        .tag-difficulty.hard {
            background: #ffebee;
            color: #c62828;
        }
        
        .tag-type {
            background: #e3f2fd;
            color: #1565c0;
        }
        
        .question-content {
            font-size: 18px;
            line-height: 1.8;
            color: #333;
            margin-bottom: 24px;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }
        
        .answer-section {
            margin-top: 24px;
        }
        
        .answer-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        
        .answer-header h4 {
            font-size: 16px;
            color: #333;
        }
        
        .answer-content {
            padding: 24px;
            background: #f5f5f5;
            border-radius: 12px;
            line-height: 1.8;
            color: #333;
            display: none;
        }
        
        .answer-content.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .action-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
        }
        
        .feedback-buttons {
            display: flex;
            gap: 8px;
        }
        
        .feedback-btn {
            padding: 8px 16px;
            border: 2px solid #e8e8e8;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 13px;
            color: #666;
        }
        
        .feedback-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }
        
        .feedback-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .navigation {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .nav-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .nav-btn:disabled {
            background: #e8e8e8;
            color: #999;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .question-number {
            font-size: 14px;
            color: #666;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            color: #ccc;
        }
        
        .empty-state h3 {
            font-size: 18px;
            color: #333;
            margin-bottom: 8px;
        }
        
        .empty-state p {
            color: #666;
            font-size: 14px;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e8e8e8;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 16px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
            transition: width 0.3s;
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #f0f0f0;
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }
            
            header {
                padding: 16px 20px;
            }
            
            header h1 {
                font-size: 22px;
            }
            
            .action-bar {
                flex-direction: column;
                gap: 16px;
            }
            
            .feedback-buttons {
                width: 100%;
                justify-content: center;
            }
            
            .navigation {
                width: 100%;
                justify-content: space-between;
            }
        }
        
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-overlay.show {
            display: flex;
        }
        
        .modal {
            background: white;
            border-radius: 16px;
            padding: 32px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal h3 {
            font-size: 20px;
            margin-bottom: 20px;
            color: #333;
        }
        
        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¤– å¤§æ¨¡å‹é¢è¯•é¢˜åº“</h1>
            <p>AIæ™ºèƒ½åˆ†ç±» Â· å…¨é¢è¦†ç›– Â· é«˜æ•ˆåˆ·é¢˜</p>
            <div class="search-section">
                <input type="text" class="search-input" id="searchKeyword" placeholder="è¾“å…¥å…³é”®è¯ï¼ˆå¦‚ï¼šTransformerã€RLHFã€RAGï¼‰ä»å°çº¢ä¹¦çˆ¬å–ç›¸å…³é¢˜ç›®" />
                <button class="btn-crawl" id="crawlBtn" onclick="startCrawl()">
                    ğŸ” çˆ¬å–é¢˜ç›®
                </button>
            </div>
            <div class="crawl-status" id="crawlStatus"></div>
        </header>
        
        <div class="main-content">
            <aside class="sidebar">
                <h3>ğŸ“š é¢˜ç›®åˆ†ç±»</h3>
                <ul class="category-list" id="categoryList">
                    <li class="category-item active" data-category="all">
                        <span class="name">å…¨éƒ¨é¢˜ç›®</span>
                        <span class="count" id="allCount">0</span>
                    </li>
                    <li class="category-item" data-category="transformer">
                        <span class="name">Transformer</span>
                        <span class="count" id="transformerCount">0</span>
                    </li>
                    <li class="category-item" data-category="llm_fundamentals">
                        <span class="name">LLMåŸºç¡€çŸ¥è¯†</span>
                        <span class="count" id="llm_fundamentalsCount">0</span>
                    </li>
                    <li class="category-item" data-category="rlhf">
                        <span class="name">RLHFå¯¹é½</span>
                        <span class="count" id="rlhfCount">0</span>
                    </li>
                    <li class="category-item" data-category="rag">
                        <span class="name">RAGæ£€ç´¢å¢å¼º</span>
                        <span class="count" id="ragCount">0</span>
                    </li>
                    <li class="category-item" data-category="prompt_engineering">
                        <span class="name">æç¤ºå·¥ç¨‹</span>
                        <span class="count" id="prompt_engineeringCount">0</span>
                    </li>
                    <li class="category-item" data-category="deployment">
                        <span class="name">éƒ¨ç½²ä¸æ¨ç†</span>
                        <span class="count" id="deploymentCount">0</span>
                    </li>
                    <li class="category-item" data-category="coding">
                        <span class="name">ç¼–ç¨‹å®è·µ</span>
                        <span class="count" id="codingCount">0</span>
                    </li>
                    <li class="category-item" data-category="math">
                        <span class="name">æ•°å­¦åŸºç¡€</span>
                        <span class="count" id="mathCount">0</span>
                    </li>
                    <li class="category-item" data-category="nlp">
                        <span class="name">NLPåŸºç¡€</span>
                        <span class="count" id="nlpCount">0</span>
                    </li>
                </ul>
                
                <div class="filter-section" style="margin-top: 24px;">
                    <label>ğŸ¯ éš¾åº¦ç­›é€‰</label>
                    <select id="difficultyFilter">
                        <option value="">å…¨éƒ¨éš¾åº¦</option>
                        <option value="easy">â­ ç®€å•</option>
                        <option value="medium">â­â­ ä¸­ç­‰</option>
                        <option value="hard">â­â­â­ å›°éš¾</option>
                    </select>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="value" id="totalQuestions">0</div>
                        <div class="label">æ€»é¢˜ç›®æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="value" id="completedQuestions">0</div>
                        <div class="label">å·²åˆ·é¢˜ç›®</div>
                    </div>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <p style="text-align: center; margin-top: 8px; font-size: 12px; color: #666;" id="progressText">å®Œæˆè¿›åº¦ 0%</p>
            </aside>
            
            <main class="content-area">
                <div class="question-header">
                    <div class="question-count">
                        å½“å‰é¢˜ç›®ï¼š<span id="currentIndex">0</span> / <span id="totalIndex">0</span>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="shuffleQuestions()">
                            ğŸ”€ éšæœºæ‰“ä¹±
                        </button>
                        <button class="btn btn-primary" onclick="showSettings()">
                            âš™ï¸ è®¾ç½®
                        </button>
                    </div>
                </div>
                
                <div id="questionContainer">
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                        </svg>
                        <h3>æš‚æ— é¢˜ç›®</h3>
                        <p>è¯·å…ˆåŠ è½½é¢˜åº“æˆ–è°ƒæ•´ç­›é€‰æ¡ä»¶</p>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <h3>âš™ï¸ åˆ·é¢˜è®¾ç½®</h3>
            <div class="filter-section">
                <label>ğŸ“ æ¯æ¬¡æ˜¾ç¤ºé¢˜ç›®æ•°é‡</label>
                <select id="batchSize">
                    <option value="1">1 é¢˜</option>
                    <option value="5" selected>5 é¢˜</option>
                    <option value="10">10 é¢˜</option>
                    <option value="20">20 é¢˜</option>
                </select>
            </div>
            <div class="filter-section">
                <label>ğŸ­ ç­”æ¡ˆæ˜¾ç¤ºæ–¹å¼</label>
                <select id="answerDisplay">
                    <option value="manual">æ‰‹åŠ¨ç‚¹å‡»æ˜¾ç¤º</option>
                    <option value="auto">è‡ªåŠ¨æ˜¾ç¤º</option>
                    <option value="timeout">3ç§’åè‡ªåŠ¨æ˜¾ç¤º</option>
                </select>
            </div>
            <div style="display: flex; gap: 12px; margin-top: 24px;">
                <button class="btn btn-primary" style="flex: 1;" onclick="saveSettings()">ä¿å­˜è®¾ç½®</button>
                <button class="btn btn-secondary" onclick="closeSettings()">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <script>
        let questionBank = {
            questions: [],
            currentIndex: 0,
            filteredQuestions: [],
            settings: {
                batchSize: 5,
                answerDisplay: 'manual'
            },
            completedQuestions: new Set()
        };
        
        async function loadQuestions() {
            try {
                const response = await fetch('/api/question-bank/questions');
                const data = await response.json();
                
                if (data.code === 0 && data.data) {
                    questionBank.questions = data.data.questions;
                    questionBank.filteredQuestions = [...questionBank.questions];
                    
                    updateCategoryCounts();
                    updateStats();
                    renderQuestion();
                    
                    document.getElementById('totalIndex').textContent = questionBank.filteredQuestions.length;
                } else {
                    loadSampleQuestions();
                }
            } catch (error) {
                console.log('åŠ è½½é¢˜åº“å¤±è´¥ï¼Œä½¿ç”¨ç¤ºä¾‹æ•°æ®:', error);
                loadSampleQuestions();
            }
        }
        
        function loadSampleQuestions() {
            questionBank.questions = [
                {
                    id: 1,
                    content: 'è¯·è¯¦ç»†è§£é‡ŠTransformerä¸­çš„Self-Attentionæœºåˆ¶ï¼ŒåŒ…æ‹¬è®¡ç®—å…¬å¼å’Œå…·ä½“å®ç°æ­¥éª¤ã€‚',
                    answer: 'Self-Attentionæ˜¯Transformerçš„æ ¸å¿ƒæœºåˆ¶ã€‚è®¡ç®—å…¬å¼ï¼š\n\nAttention(Q, K, V) = softmax(QK^T/âˆšd_k)V\n\nå®ç°æ­¥éª¤ï¼š\n1. å°†è¾“å…¥å‘é‡è½¬æ¢ä¸ºQï¼ˆæŸ¥è¯¢ï¼‰ã€Kï¼ˆé”®ï¼‰ã€Vï¼ˆå€¼ï¼‰ä¸‰ä¸ªçŸ©é˜µ\n2. è®¡ç®—Qä¸Kçš„ç‚¹ç§¯ï¼Œå¾—åˆ°æ³¨æ„åŠ›åˆ†æ•°\n3. é™¤ä»¥âˆšd_kè¿›è¡Œç¼©æ”¾ï¼Œé˜²æ­¢ç‚¹ç§¯å€¼è¿‡å¤§\n4. åº”ç”¨softmaxè·å¾—æ³¨æ„åŠ›æƒé‡\n5. ç”¨æ³¨æ„åŠ›æƒé‡å¯¹Vè¿›è¡ŒåŠ æƒæ±‚å’Œ\n\nå¤šå¤´æ³¨æ„åŠ›å…è®¸æ¨¡å‹åŒæ—¶å…³æ³¨ä¸åŒä½ç½®çš„ä¸åŒè¡¨ç¤ºå­ç©ºé—´çš„ä¿¡æ¯ã€‚',
                    category: 'transformer',
                    difficulty: 'medium',
                    type: 'ç®€ç­”é¢˜'
                },
                {
                    id: 2,
                    content: 'LLMçš„é¢„è®­ç»ƒé˜¶æ®µé€šå¸¸ä½¿ç”¨å“ªç§ç›®æ ‡å‡½æ•°ï¼Ÿè¯·è§£é‡Šå…¶åŸç†å’Œä½œç”¨ã€‚',
                    answer: 'LLMé¢„è®­ç»ƒä¸»è¦ä½¿ç”¨è‡ªå›å½’è¯­è¨€å»ºæ¨¡ç›®æ ‡ï¼ˆNext Token Predictionï¼‰ã€‚\n\nåŸç†ï¼šç»™å®šä¸€ä¸ªtokenåºåˆ— [t1, t2, ..., tn]ï¼Œæ¨¡å‹å­¦ä¹ é¢„æµ‹ä¸‹ä¸€ä¸ªtoken tn+1ã€‚\n\næŸå¤±å‡½æ•°ï¼šL = -Î£ log P(tn+1 | t1, ..., tn)\n\nä½œç”¨ï¼š\n1. è®©æ¨¡å‹å­¦ä¹ è¯­è¨€çš„ç»Ÿè®¡è§„å¾‹å’Œè¯­ä¹‰çŸ¥è¯†\n2. æ•æ‰ä¸Šä¸‹æ–‡ä¾èµ–å…³ç³»\n3. å»ºç«‹ä¸–ç•ŒçŸ¥è¯†çš„åŸºç¡€è¡¨ç¤º\n4. ä¸ºä¸‹æ¸¸ä»»åŠ¡æä¾›é€šç”¨èƒ½åŠ›',
                    category: 'llm_fundamentals',
                    difficulty: 'easy',
                    type: 'æ¦‚å¿µé¢˜'
                },
                {
                    id: 3,
                    content: 'ä»€ä¹ˆæ˜¯RLHFï¼ˆåŸºäºäººç±»åé¦ˆçš„å¼ºåŒ–å­¦ä¹ ï¼‰ï¼Ÿå®ƒçš„ä¸‰ä¸ªä¸»è¦æ­¥éª¤æ˜¯ä»€ä¹ˆï¼Ÿ',
                    answer: 'RLHFæ˜¯ä¸€ç§è®©AIç³»ç»Ÿä¸äººç±»åå¥½å¯¹é½çš„æŠ€æœ¯ã€‚\n\nä¸‰ä¸ªä¸»è¦æ­¥éª¤ï¼š\n\n1. ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰ï¼šä½¿ç”¨é«˜è´¨é‡ç¤ºä¾‹æ•°æ®å¯¹é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œå¾®è°ƒ\n2. å¥–åŠ±æ¨¡å‹è®­ç»ƒï¼šæ”¶é›†äººç±»å¯¹ä¸åŒè¾“å‡ºçš„åå¥½æ’åºï¼Œè®­ç»ƒå¥–åŠ±æ¨¡å‹\n3. PPOä¼˜åŒ–ï¼šä½¿ç”¨PPOç®—æ³•å’Œå¥–åŠ±æ¨¡å‹ä¼˜åŒ–ç­–ç•¥æ¨¡å‹\n\nå…³é”®æŒ‘æˆ˜ï¼š\n- å¥–åŠ±é»‘å®¢æ”»å‡»\n- äººç±»åé¦ˆçš„è´¨é‡å’Œä¸€è‡´æ€§\n- è®­ç»ƒç¨³å®šæ€§',
                    category: 'rlhf',
                    difficulty: 'hard',
                    type: 'ç»¼åˆé¢˜'
                },
                {
                    id: 4,
                    content: 'RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰çš„å·¥ä½œæµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿå®ƒå¦‚ä½•è§£å†³LLMçš„çŸ¥è¯†æˆªæ­¢é—®é¢˜ï¼Ÿ',
                    answer: 'RAGå·¥ä½œæµç¨‹ï¼š\n\n1. ç´¢å¼•é˜¶æ®µï¼š\n   - æ–‡æ¡£åˆ†å—ï¼ˆchunkingï¼‰\n   - å‘é‡åŒ–ï¼ˆä½¿ç”¨embeddingæ¨¡å‹ï¼‰\n   - å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“\n\n2. æ£€ç´¢é˜¶æ®µï¼š\n   - å°†ç”¨æˆ·æŸ¥è¯¢å‘é‡åŒ–\n   - åœ¨å‘é‡åº“ä¸­æ£€ç´¢ç›¸ä¼¼æ–‡æ¡£\n   - è¿”å›top-kç›¸å…³æ–‡æ¡£\n\n3. ç”Ÿæˆé˜¶æ®µï¼š\n   - å°†æ£€ç´¢åˆ°çš„æ–‡æ¡£ä¸æŸ¥è¯¢æ‹¼æ¥\n   - è¾“å…¥LLMç”Ÿæˆå›ç­”\n\nè§£å†³çŸ¥è¯†æˆªæ­¢é—®é¢˜çš„åŸç†ï¼š\n- å®æ—¶æ£€ç´¢æœ€æ–°ä¿¡æ¯\n- ä¸éœ€è¦é‡æ–°è®­ç»ƒæ¨¡å‹\n- æä¾›å¯è¿½æº¯çš„å‚è€ƒæ¥æº',
                    category: 'rag',
                    difficulty: 'medium',
                    type: 'æµç¨‹é¢˜'
                },
                {
                    id: 5,
                    content: 'è¯·è§£é‡ŠPrompt Engineeringä¸­çš„Few-Shot Learningæ¦‚å¿µï¼Œå¹¶ç»™å‡ºå®é™…åº”ç”¨ç¤ºä¾‹ã€‚',
                    answer: 'Few-Shot Learningæ˜¯åœ¨æç¤ºä¸­æä¾›å°‘é‡ç¤ºä¾‹ï¼Œè®©æ¨¡å‹å­¦ä¹ ä»»åŠ¡æ¨¡å¼ã€‚\n\næ ¼å¼ï¼š\n- Zero-shotï¼šæ— ç¤ºä¾‹ï¼Œç›´æ¥æŒ‡ä»¤\n- One-shotï¼šä¸€ä¸ªç¤ºä¾‹\n- Few-shotï¼š2-5ä¸ªç¤ºä¾‹\n\næœ€ä½³å®è·µï¼š\n1. ç¤ºä¾‹è¦æœ‰ä»£è¡¨æ€§ï¼Œæ¶µç›–ä¸åŒæƒ…å†µ\n2. ä¿æŒç¤ºä¾‹æ ¼å¼ä¸€è‡´\n3. ç›¸ä¼¼ç¤ºä¾‹æ”¾å‰é¢\n4. æ ‡ç­¾åˆ†å¸ƒè¦å‡è¡¡\n\nç¤ºä¾‹ï¼š\n\nå°†è¯„è®ºåˆ†ç±»ä¸ºæ­£é¢/è´Ÿé¢ï¼š\nè¯„è®ºï¼šæˆ‘å–œæ¬¢è¿™ä¸ªäº§å“ï¼Œéå¸¸å®ç”¨ï¼\næ ‡ç­¾ï¼šæ­£é¢\n\nè¯„è®ºï¼šè´¨é‡å¾ˆå·®ï¼Œä¸æ¨èè´­ä¹°ã€‚\næ ‡ç­¾ï¼šè´Ÿé¢\n\nè¯„è®ºï¼šå¤–è§‚ä¸é”™ï¼Œä½†åŠŸèƒ½ä¸€èˆ¬ã€‚\næ ‡ç­¾ï¼šï¼Ÿ',
                    category: 'prompt_engineering',
                    difficulty: 'easy',
                    type: 'åº”ç”¨é¢˜'
                },
                {
                    id: 6,
                    content: 'LLMéƒ¨ç½²ä¸­å¸¸è§çš„é‡åŒ–æŠ€æœ¯æœ‰å“ªäº›ï¼Ÿå®ƒä»¬å¦‚ä½•å‡å°‘æ¨¡å‹å¤§å°å’ŒåŠ é€Ÿæ¨ç†ï¼Ÿ',
                    answer: 'å¸¸è§é‡åŒ–æŠ€æœ¯ï¼š\n\n1. è®­ç»ƒåé‡åŒ–ï¼ˆPTQï¼‰ï¼š\n   - INT8é‡åŒ–ï¼šå°†32ä½æµ®ç‚¹æ•°è½¬æ¢ä¸º8ä½æ•´æ•°\n   - INT4é‡åŒ–ï¼šè¿›ä¸€æ­¥å‹ç¼©åˆ°4ä½\n   - å…¸å‹å·¥å…·ï¼šTensorRTã€ONNX Runtime\n\n2. é‡åŒ–æ„ŸçŸ¥è®­ç»ƒï¼ˆQATï¼‰ï¼š\n   - åœ¨è®­ç»ƒä¸­æ¨¡æ‹Ÿé‡åŒ–æ•ˆæœ\n   - ä¿æŒæ›´å¥½çš„æ¨¡å‹ç²¾åº¦\n\n3. GPTQ/AWQï¼š\n   - åŸºäºåˆ†å±‚ä¼˜åŒ–\n   - ä¿æŒæ¨¡å‹è´¨é‡çš„å‹ç¼©\n\næ•ˆæœï¼š\n- æ¨¡å‹å¤§å°å‡å°‘2-4å€\n- æ¨ç†é€Ÿåº¦æå‡2-3å€\n- æ˜¾å­˜å ç”¨æ˜¾è‘—é™ä½',
                    category: 'deployment',
                    difficulty: 'medium',
                    type: 'æŠ€æœ¯é¢˜'
                },
                {
                    id: 7,
                    content: 'è¯·ç”¨Pythonå®ç°ä¸€ä¸ªç®€å•çš„Transformerå¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ã€‚',
                    answer: '```python\nimport torch\nimport torch.nn.functional as F\n\nclass MultiHeadAttention(nn.Module):\n    def __init__(self, d_model, num_heads):\n        super().__init__()\n        self.d_model = d_model\n        self.num_heads = num_heads\n        self.head_dim = d_model // num_heads\n        \n        self.W_q = nn.Linear(d_model, d_model)\n        self.W_k = nn.Linear(d_model, d_model)\n        self.W_v = nn.Linear(d_model, d_model)\n        self.W_o = nn.Linear(d_model, d_model)\n    \n    def forward(self, query, key, value, mask=None):\n        batch_size = query.size(0)\n        \n        # çº¿æ€§å˜æ¢å¹¶åˆ†å‰²ä¸ºå¤šå¤´\n        Q = self.W_q(query).view(batch_size, -1, self.num_heads, self.head_dim).transpose(1, 2)\n        K = self.W_k(key).view(batch_size, -1, self.num_heads, self.head_dim).transpose(1, 2)\n        V = self.W_v(value).view(batch_size, -1, self.num_heads, self.head_dim).transpose(1, 2)\n        \n        # Scaled dot-product attention\n        scores = torch.matmul(Q, K.transpose(-2, -1)) / math.sqrt(self.head_dim)\n        \n        if mask is not None:\n            scores = scores.masked_fill(mask == 0, -1e9)\n        \n        attention = F.softmax(scores, dim=-1)\n        output = torch.matmul(attention, V)\n        \n        # åˆå¹¶å¤šå¤´\n        output = output.transpose(1, 2).contiguous().view(batch_size, -1, d_model)\n        \n        return self.W_o(output)\n```',
                    category: 'coding',
                    difficulty: 'hard',
                    type: 'ç¼–ç¨‹é¢˜'
                },
                {
                    id: 8,
                    content: 'åœ¨ä¼˜åŒ–LLMæ—¶ï¼Œå¦‚ä½•è®¡ç®—å’Œç†è§£å›°æƒ‘åº¦ï¼ˆPerplexityï¼‰ï¼Ÿå®ƒä¸æ¨¡å‹è´¨é‡æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ',
                    answer: 'å›°æƒ‘åº¦ï¼ˆPerplexityï¼‰å®šä¹‰ï¼š\n\nPPL = 2^(-1/N * Î£ log P(xi))\n\næˆ–ç­‰ä»·äºï¼š\nPPL = exp(-1/N * Î£ log P(xi))\n\nè®¡ç®—æ­¥éª¤ï¼š\n1. å¯¹æµ‹è¯•é›†çš„æ¯ä¸ªtokenè®¡ç®—é¢„æµ‹æ¦‚ç‡\n2. å–å¯¹æ•°æ¦‚ç‡çš„å¹³å‡å€¼\n3. å–æŒ‡æ•°\n\nç†è§£ï¼š\n- å›°æƒ‘åº¦è¶Šä½ï¼Œæ¨¡å‹å¯¹æ•°æ®çš„é¢„æµ‹è¶Šå‡†ç¡®\n- ç›¸å½“äºæ¨¡å‹åœ¨æ¯ä¸ªä½ç½®çš„"æœ‰æ•ˆè¯æ±‡é‡"\n- PPL=100æ„å‘³ç€æ¨¡å‹é¢„æµ‹ä¸‹ä¸€ä¸ªè¯æ—¶ç›¸å½“äºä»100ä¸ªè¯ä¸­é€‰æ‹©\n\nä¸è´¨é‡çš„å…³ç³»ï¼š\n- å›°æƒ‘åº¦æ˜¯é‡è¦çš„è¯„ä¼°æŒ‡æ ‡ï¼Œä½†ä¸æ˜¯å”¯ä¸€æŒ‡æ ‡\n- ä½å›°æƒ‘åº¦ â‰  å¥½çš„ç”Ÿæˆè´¨é‡\n- éœ€è¦ç»“åˆäººå·¥è¯„ä¼°ç»¼åˆåˆ¤æ–­',
                    category: 'math',
                    difficulty: 'medium',
                    type: 'æ¦‚å¿µé¢˜'
                },
                {
                    id: 9,
                    content: 'è¯·è§£é‡ŠWord2Vecçš„å·¥ä½œåŸç†ï¼ŒåŒ…æ‹¬CBOWå’ŒSkip-gramä¸¤ç§æ¨¡å‹ç»“æ„ã€‚',
                    answer: 'Word2Vecæ˜¯ç»å…¸çš„è¯å‘é‡å­¦ä¹ æ–¹æ³•ã€‚\n\næ ¸å¿ƒæ€æƒ³ï¼šé€šè¿‡ä¸Šä¸‹æ–‡é¢„æµ‹ç›®æ ‡è¯ï¼ˆæˆ–åä¹‹ï¼‰ï¼Œå­¦ä¹ è¯çš„åˆ†å¸ƒå¼è¡¨ç¤ºã€‚\n\nCBOWï¼ˆContinuous Bag of Wordsï¼‰ï¼š\n- è¾“å…¥ï¼šä¸Šä¸‹æ–‡è¯çš„å‘é‡\n- è¾“å‡ºï¼šç›®æ ‡è¯çš„å‘é‡\n- é€‚åˆå°æ•°æ®é›†\n\nSkip-gramï¼š\n- è¾“å…¥ï¼šç›®æ ‡è¯çš„å‘é‡\n- è¾“å‡ºï¼šä¸Šä¸‹æ–‡è¯çš„å‘é‡\n- é€‚åˆå¤§æ•°æ®é›†ï¼Œæ•ˆæœé€šå¸¸æ›´å¥½\n\nè®­ç»ƒæŠ€å·§ï¼š\n1. è´Ÿé‡‡æ ·ï¼šéšæœºé€‰æ‹©è´Ÿæ ·æœ¬æ›¿ä»£å…¨éƒ¨softmax\n2. å±‚æ¬¡softmaxï¼šä½¿ç”¨éœå¤«æ›¼æ ‘åŠ é€Ÿè®¡ç®—\n\nè¾“å‡ºï¼šè¯å‘é‡å¯ä»¥æ•æ‰è¯­ä¹‰å…³ç³»\nå¦‚ï¼švec(king) - vec(man) + vec(woman) â‰ˆ vec(queen)',
                    category: 'nlp',
                    difficulty: 'easy',
                    type: 'æ¦‚å¿µé¢˜'
                },
                {
                    id: 10,
                    content: 'Transformerä¸­çš„ä½ç½®ç¼–ç æœ‰å“ªäº›å¸¸è§æ–¹æ³•ï¼Ÿå®ƒä»¬å„è‡ªçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ',
                    answer: 'å¸¸è§ä½ç½®ç¼–ç æ–¹æ³•ï¼š\n\n1. ç»å¯¹ä½ç½®ç¼–ç ï¼š\n   - å¯å­¦ä¹ ä½ç½®åµŒå…¥ï¼šè®­ç»ƒæ—¶å­¦ä¹ \n   - æ­£å¼¦ä½ç½®ç¼–ç ï¼šä½¿ç”¨sin/coså‡½æ•°\n   ä¼˜ç‚¹ï¼šç®€å•ç›´è§‚\n   ç¼ºç‚¹ï¼šéš¾ä»¥æ³›åŒ–åˆ°æ›´é•¿åºåˆ—\n\n2. ç›¸å¯¹ä½ç½®ç¼–ç ï¼š\n   - Transformer-XLé£æ ¼\n   - attention with relative positional bias\n   ä¼˜ç‚¹ï¼šå¯æ³›åŒ–åˆ°æœªè§è¿‡çš„é•¿åº¦\n   ç¼ºç‚¹ï¼šå®ç°å¤æ‚ï¼Œè®¡ç®—å¼€é”€å¤§\n\n3. æ—‹è½¬ä½ç½®ç¼–ç ï¼ˆRoPEï¼‰ï¼š\n   - ç”¨äºLLaMAç­‰æ¨¡å‹\n   - é€šè¿‡æ—‹è½¬æ“ä½œç¼–ç ç›¸å¯¹ä½ç½®\n   ä¼˜ç‚¹ï¼šæ•ˆæœå¥½ï¼Œæ”¯æŒé•¿ä¸Šä¸‹æ–‡\n\n4. ALiBiï¼š\n   - ç®€å•çš„çº¿æ€§åç½®\n   - æ— éœ€é¢å¤–å‚æ•°\n   ä¼˜ç‚¹ï¼šè®­ç»ƒå’Œæ¨ç†é«˜æ•ˆ',
                    category: 'transformer',
                    difficulty: 'hard',
                    type: 'ç»¼åˆé¢˜'
                }
            ];
            
            questionBank.filteredQuestions = [...questionBank.questions];
            updateCategoryCounts();
            updateStats();
            renderQuestion();
            
            document.getElementById('totalIndex').textContent = questionBank.filteredQuestions.length;
        }
        
        function updateCategoryCounts() {
            const categories = [
                'all', 'transformer', 'llm_fundamentals', 'rlhf', 'rag',
                'prompt_engineering', 'deployment', 'coding', 'math', 'nlp'
            ];
            
            categories.forEach(cat => {
                if (cat === 'all') {
                    document.getElementById('allCount').textContent = questionBank.questions.length;
                } else {
                    const count = questionBank.questions.filter(q => q.category === cat).length;
                    const element = document.getElementById(cat + 'Count');
                    if (element) {
                        element.textContent = count;
                    }
                }
            });
        }
        
        function updateStats() {
            document.getElementById('totalQuestions').textContent = questionBank.questions.length;
            document.getElementById('completedQuestions').textContent = questionBank.completedQuestions.size;
            
            const progress = questionBank.questions.length > 0 
                ? (questionBank.completedQuestions.size / questionBank.questions.length * 100).toFixed(1)
                : 0;
            
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = 'å®Œæˆè¿›åº¦ ' + progress + '%';
        }
        
        function renderQuestion() {
            const container = document.getElementById('questionContainer');
            
            if (questionBank.filteredQuestions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                        </svg>
                        <h3>æš‚æ— ç¬¦åˆæ¡ä»¶çš„é¢˜ç›®</h3>
                        <p>è¯·å°è¯•å…¶ä»–ç­›é€‰æ¡ä»¶</p>
                    </div>
                `;
                return;
            }
            
            const question = questionBank.filteredQuestions[questionBank.currentIndex];
            const isCompleted = questionBank.completedQuestions.has(question.id);
            
            container.innerHTML = `
                <div class="question-card">
                    <div class="question-meta">
                        <span class="tag tag-category">${getCategoryName(question.category)}</span>
                        <span class="tag tag-difficulty ${question.difficulty}">${getDifficultyName(question.difficulty)}</span>
                        <span class="tag tag-type">${question.type}</span>
                    </div>
                    
                    <div class="question-content">
                        ${question.content}
                    </div>
                    
                    <div class="answer-section">
                        <div class="answer-header">
                            <h4>ğŸ“– å‚è€ƒç­”æ¡ˆ</h4>
                            <button class="btn btn-primary" onclick="toggleAnswer()">
                                ${isAnswerVisible() ? 'æ”¶èµ·ç­”æ¡ˆ' : 'æ˜¾ç¤ºç­”æ¡ˆ'}
                            </button>
                        </div>
                        <div class="answer-content ${isAnswerVisible() ? 'show' : ''}" id="answerContent">
                            ${formatAnswer(question.answer)}
                        </div>
                    </div>
                    
                    <div class="action-bar">
                        <div class="feedback-buttons">
                            <button class="feedback-btn ${isCompleted ? 'active' : ''}" onclick="markCompleted(${question.id}, this)">
                                âœ… å·²æŒæ¡
                            </button>
                            <button class="feedback-btn" onclick="markReviewLater(${question.id})">
                                ğŸ”„ ç¨åå†ç»ƒ
                            </button>
                        </div>
                        
                        <div class="navigation">
                            <button class="nav-btn" onclick="prevQuestion()" ${questionBank.currentIndex === 0 ? 'disabled' : ''}>
                                â† ä¸Šä¸€é¢˜
                            </button>
                            <span class="question-number">${questionBank.currentIndex + 1} / ${questionBank.filteredQuestions.length}</span>
                            <button class="nav-btn" onclick="nextQuestion()" ${questionBank.currentIndex >= questionBank.filteredQuestions.length - 1 ? 'disabled' : ''}>
                                ä¸‹ä¸€é¢˜ â†’
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('currentIndex').textContent = questionBank.currentIndex + 1;
            document.getElementById('totalIndex').textContent = questionBank.filteredQuestions.length;
        }
        
        function getCategoryName(category) {
            const names = {
                'transformer': 'Transformer',
                'llm_fundamentals': 'LLMåŸºç¡€',
                'rlhf': 'RLHFå¯¹é½',
                'rag': 'RAGæ£€ç´¢',
                'prompt_engineering': 'æç¤ºå·¥ç¨‹',
                'deployment': 'éƒ¨ç½²æ¨ç†',
                'coding': 'ç¼–ç¨‹å®è·µ',
                'math': 'æ•°å­¦åŸºç¡€',
                'nlp': 'NLPåŸºç¡€'
            };
            return names[category] || category;
        }
        
        function getDifficultyName(difficulty) {
            const names = {
                'easy': 'â­ ç®€å•',
                'medium': 'â­â­ ä¸­ç­‰',
                'hard': 'â­â­â­ å›°éš¾'
            };
            return names[difficulty] || difficulty;
        }
        
        function formatAnswer(answer) {
            return answer.replace(/```(\w*)\n([\s\S]*?)```/g, (match, lang, code) => {
                return `<pre><code class="language-${lang}">${code.trim()}</code></pre>`;
            }).replace(/\n/g, '<br>');
        }
        
        let answerVisible = false;
        
        function isAnswerVisible() {
            return answerVisible;
        }
        
        function toggleAnswer() {
            answerVisible = !answerVisible;
            const content = document.getElementById('answerContent');
            if (content) {
                content.classList.toggle('show', answerVisible);
                content.style.display = answerVisible ? 'block' : 'none';
            }
        }
        
        function markCompleted(id, btn) {
            questionBank.completedQuestions.add(id);
            btn.classList.add('active');
            updateStats();
            
            if (questionBank.settings.answerDisplay === 'auto') {
                setTimeout(() => {
                    nextQuestion();
                }, 2000);
            }
        }
        
        function markReviewLater(id) {
            const question = questionBank.questions.find(q => q.id === id);
            if (question) {
                questionBank.filteredQuestions.push(question);
                renderQuestion();
            }
        }
        
        function prevQuestion() {
            if (questionBank.currentIndex > 0) {
                questionBank.currentIndex--;
                answerVisible = false;
                renderQuestion();
            }
        }
        
        function showCrawlStatus(message, isLoading = false) {
            const statusEl = document.getElementById('crawlStatus');
            statusEl.innerHTML = isLoading 
                ? `<span class="loading-spinner" style="display:inline-block;width:16px;height:16px;border:2px solid #e8e8e8;border-top-color:#667eea;border-radius:50%;animation:spin 1s linear infinite;margin-right:8px;vertical-align:middle;"></span>${message}`
                : message;
            statusEl.classList.add('show');
        }
        
        function hideCrawlStatus() {
            document.getElementById('crawlStatus').classList.remove('show');
        }
        
        async function startCrawl() {
            const keyword = document.getElementById('searchKeyword').value.trim();
            
            if (!keyword) {
                showCrawlStatus('âš ï¸ è¯·è¾“å…¥æœç´¢å…³é”®è¯');
                return;
            }
            
            const crawlBtn = document.getElementById('crawlBtn');
            crawlBtn.disabled = true;
            showCrawlStatus(`æ­£åœ¨ä»å°çº¢ä¹¦çˆ¬å– "${keyword}" ç›¸å…³é¢˜ç›®...`, true);
            
            try {
                const response = await fetch('/api/question-bank/crawl', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        keyword: keyword,
                        max_pages: 2,
                        page_size: 10
                    })
                });
                
                const data = await response.json();
                
                if (data.code === 0) {
                    showCrawlStatus(`âœ… æˆåŠŸçˆ¬å– ${data.data.crawled_count} é“æ–°é¢˜ç›®ï¼é¢˜ç›®æ€»æ•°ï¼š${data.data.total_count}`);
                    await loadQuestions();
                    
                    setTimeout(() => {
                        hideCrawlStatus();
                    }, 3000);
                } else {
                    showCrawlStatus(`âŒ çˆ¬å–å¤±è´¥ï¼š${data.message}`);
                }
            } catch (error) {
                console.error('çˆ¬å–é”™è¯¯:', error);
                showCrawlStatus(`âŒ çˆ¬å–å¤±è´¥ï¼š${error.message || 'ç½‘ç»œé”™è¯¯'}`);
            } finally {
                crawlBtn.disabled = false;
            }
        }
        
        function nextQuestion() {
            if (questionBank.currentIndex < questionBank.filteredQuestions.length - 1) {
                questionBank.currentIndex++;
                answerVisible = false;
                renderQuestion();
            }
        }
        
        function shuffleQuestions() {
            for (let i = questionBank.filteredQuestions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [questionBank.filteredQuestions[i], questionBank.filteredQuestions[j]] = 
                [questionBank.filteredQuestions[j], questionBank.filteredQuestions[i]];
            }
            questionBank.currentIndex = 0;
            answerVisible = false;
            renderQuestion();
        }
        
        function showSettings() {
            document.getElementById('settingsModal').classList.add('show');
        }
        
        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('show');
        }
        
        function saveSettings() {
            questionBank.settings.batchSize = parseInt(document.getElementById('batchSize').value);
            questionBank.settings.answerDisplay = document.getElementById('answerDisplay').value;
            closeSettings();
        }
        
        document.getElementById('categoryList').addEventListener('click', function(e) {
            const item = e.target.closest('.category-item');
            if (item) {
                document.querySelectorAll('.category-item').forEach(el => el.classList.remove('active'));
                item.classList.add('active');
                
                const category = item.dataset.category;
                filterQuestions(category, document.getElementById('difficultyFilter').value);
            }
        });
        
        document.getElementById('difficultyFilter').addEventListener('change', function() {
            const category = document.querySelector('.category-item.active').dataset.category;
            filterQuestions(category, this.value);
        });
        
        function filterQuestions(category, difficulty) {
            let filtered = [...questionBank.questions];
            
            if (category && category !== 'all') {
                filtered = filtered.filter(q => q.category === category);
            }
            
            if (difficulty) {
                filtered = filtered.filter(q => q.difficulty === difficulty);
            }
            
            questionBank.filteredQuestions = filtered;
            questionBank.currentIndex = 0;
            answerVisible = false;
            
            document.getElementById('totalIndex').textContent = filtered.length;
            renderQuestion();
        }
        
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                prevQuestion();
            } else if (e.key === 'ArrowRight') {
                nextQuestion();
            } else if (e.key === ' ' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
                e.preventDefault();
                toggleAnswer();
            }
        });
        
        document.getElementById('settingsModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeSettings();
            }
        });
        
        window.onload = function() {
            loadQuestions();
        };
    </script>
</body>
</html>
